{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "Config.json",
  "title": "Config",
  "description": "Connector configuration schema.",
  "type": "object",
  "properties": {
    "env": {
      "description": "Determines what type of network the connector is a part of. Can be: 'production', 'test'. Default: 'test'",
      "type": "string",
      "enum": ["production", "test"],
      "default": "test"
    },
    "ilpAddress": {
      "description": "ILP address of the connector. This property can be omitted if an account with `relation=parent` is configured under `accounts`.",
      "type": "string",
      "pattern": "^[a-zA-Z0-9._~-]+$",
      "default": "unknown"
    },
    "peers": {
      "description": "Description of connector account plugins.",
      "type": "object",
      "default": {},
      "additionalProperties": {
        "description": "Description of individual account.",
        "type": "object",
        "properties": {
          "id": { "type":"string" },
          "relation": {
            "description": "Relationship between the connector and the counterparty that the account is with.",
            "enum": ["parent", "peer", "child"]
          },
          "relationWeight": {
            "description": "Weighting to use in the routing table for this counterparty. Intended to be used when there are multiple parents from which to inherit an address from. The weighting will determine which address will be returned as this connectors address.",
            "type": "integer",
            "minimum": 0
          },
          "assetCode": {
            "description": "Currency code or other asset identifier that will be passed to the backend to select the correct rate for this account.",
            "type": "string"
          },
          "assetScale": {
            "description": "Interledger amounts are integers, but most currencies are typically represented as fractional units, e.g. cents. This property defines how many Interledger units make up one regular units. For dollars, this would usually be set to 9, so that Interledger amounts are expressed in nanodollars.",
            "type": "integer",
            "minimum": 0,
            "maximum": 255
          },
          "rules": {
            "description": "The business rules that should be used for this peer.",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": { "type": "string" }
              },
              "required": ["name"]
            },
            "default": []
          },
          "protocols": {
            "description": "The protocols that connector should apply for this peer.",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": { "type": "string" }
              },
              "required": ["name"]
            },
            "default": []
          },
          "endpoint": {
            "description": "Information to describe which endpoint to use for this peer",
            "type": "object",
            "properties": {
              "type": { "type": "string" },
              "url": { "type": "string" },
              "pluginOpts": {
                "type":"object",
                "properties": {
                  "name": { "type": "string" },
                  "opts": { "type": "object" }
                },
                "required": ["name", "opts"]
              }
            },
            "required": ["type"]
          },
          "settlement": {
            "description": "Information needed to communicate with a specified settlement engine and account details to use for settlement.",
            "type": "object",
            "properties": {
              "url": { "type": "string" },
              "ledgerAddress": { "type": "string" },
              "settleThreshold": {
                "description": "Balance (in this account's indivisible base units) numerically below which the connector will automatically initiate a settlement. The format is a string containing an integer (which may be prefixed with `-` to indicate a negative value) or `\"-Infinity\"`.",
                "type": "string",
                "pattern": "^(0|(-?[1-9][0-9]*|-Infinity))$"
              },
              "settleTo": {
                "description": "Balance (in this account's indivisible base units) the connector will attempt to reach when settling. The format is an integer (which may be prefixed with `-` to indicate a negative value) as a string.",
                "type": "string",
                "pattern": "^(0|-?[1-9][0-9]*)$",
                "default": "0"
              }
            },
            "required": ["url", "ledgerAddress"],
            "additionalProperties": false
          }
        },
        "required": [
          "id",
          "relation",
          "assetCode",
          "assetScale",
          "rules",
          "protocols",
          "endpoint",
          "settlement"
        ],
        "additionalProperties": false
      }
    },
    "minExpirationWindow": {
      "description": "Minimum time the connector wants to budget for getting a message to the accounts its trading on. In milliseconds.",
      "type": "integer",
      "default": 1000
    },
    "maxHoldWindow": {
      "description": "Maximum duration (in milliseconds) the connector is willing to place funds on hold while waiting for the outcome of a transaction.",
      "type": "integer",
      "default": 30000
    },
    "http2ServerPort": {
      "description": "Which port the http2 server for incoming ilp over http requests should listen on. Default: 8843",
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "default": 8443
    },
    "adminApiPort": {
      "description": "Which port the admin API should listen on. Default: 7780",
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "default": 7780
    },
    "adminApiHost": {
      "description": "Host for the admin api to bind to. Warning: The admin API interface is public by default: '0.0.0.0'",
      "type": "string",
      "default": "0.0.0.0"
    },
    "settlementAdminApiPort": {
      "description": "Which port the settlement admin API should listen on. Default: 7781",
      "type": "integer",
      "minimum": 0,
      "maximum": 65535,
      "default": 7781
    },
    "settlementAdminApiHost": {
      "description": "Host for the settlement admin api to bind to. Note: The settlement admin API interface is private: '127.0.0.1'",
      "type": "string",
      "default": "127.0.0.1"
    }
  },
  "required": ["peers"],
  "additionalProperties": false
}
